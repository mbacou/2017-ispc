# Ethiopia

```{r eth-erss, eval=FALSE}

# Load and copy constructed vars from the 2015 ETH Segmentation
setwd("~/Google Drive/2016-BMGF-Segmentation/ETH")
e1 <- new.env()
load("./temp/eth-erss-11_bmgf_seg.RData", envir=e1)
names(e1)
erss <- e1$hh
erss.lbl <- e1$hh.lb

e1 <- new.env()
# Seems more recent
load("./temp/eth_bmgf_seg.RData", envir=e1)
names(e1)
erss2 <- e1$hh
erss2.lbl <- e1$hh.lb

rm(e1)
setwd("~/Projects/2017-agra-aasr")

# Differences between the 2 set of ERSS vars?
names(erss2)[!names(erss2) %in% names(erss)]
# => merged in all seg vars, poverty, expendc, real_totcons, livestock, eff
names(erss)[!names(erss) %in% names(erss2)]
# [1] "hhid"     "input_12"

# Merge in `input_12` and keep `erss2` only
setkey(erss, household_id)
setkey(erss2, household_id)
erss[!erss2][, .(household_id, hhid)]
erss2[erss][, .(household_id, hhid)]



##########################################
# TODO ETH-RIGA

### SALES
tmp <- read.dta("~/Projects/hc-data/GHA-GLSS4/riga/Ghana98_HHCHAR.dta")
tmp.lbl <- data.table(varCode=names(tmp), varLabel=attr(tmp, "var.labels"))
writeLines(knitr::kable(gha97.lbl, format="rst"), "~/Projects/hc-data/GHA-GLSS4/temp/GHA-GLSS4_raw.log")
gha97.lbl <- unique(tmp.lbl, by="varCode")
rm(gha97.hh.lbl, gha97.inc.lbl, tmp.lbl)

tmp <- data.table(tmp)
anyDuplicated(tmp, by="hh")
tmp[, summary(hh)]
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 400200  425100  449900  450000  475000  499900 
gha97[, range(hhid)]
# [1] 400201 499920

# Merge RIGA sales
setkey(tmp, hh)
setkey(gha97, hhid)
gha97 <- tmp[gha97]
setnames(gha97, "hh", "hhid")

### INCOME
tmp <- read.dta("~/Projects/hc-data/GHA-GLSS4/riga/Ghana98_HH_INCOME.dta")
tmp.lbl <- data.table(varCode=names(tmp), varLabel=attr(tmp, "var.labels"))
gha97.lbl <- rbind(gha97.lbl, tmp.lbl)
gha97.lbl <- unique(gha97.lbl, by="varCode")

tmp <- data.table(tmp)
anyDuplicated(tmp, by="hh")
# => `hh` is unique
tmp[, summary(hh)]
#   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 400200  425100  449900  450000  475000  499900

# Merge RIGA incomes
setkey(tmp, hh)
setkey(gha97, hhid)
gha97 <- tmp[, .SD, .SDcols=c("hh", vars.inc)][gha97]
setnames(gha97, "hh", "hhid")

# Then are we sure that RIGA includes aggregates for urban hhlds?
gha97[, .(
  sum(nonagr_wge, na.rm=T),
  sum(agr_wge, na.rm=T)
), by=rural]
#    rural         V1        V2
# 1:     2  903291234 126182173
# 2:     1 1732925339  68048954
# => looks okay

```

Relevant sources of household-level micro records for Ethiopia include:

* 2011/12 ERSS (income vars)
* 2013/14 and 2015/16 Ethiopia Socioeconomic Surveys
* 2012/13 Ethiopiaâ€™s Agricultural Sample Survey (AgSS) -- but it's difficult to cross-tabulate results from the AgSS (crop production and input uses) with the ERSS' income data
* 2012 ATA Baseline Survey (3,000 hhlds), see [@minot2013agataeth].


